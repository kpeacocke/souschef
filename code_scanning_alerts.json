[{"number":97,"created_at":"2026-01-17T13:05:16Z","updated_at":"2026-01-17T13:05:16Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/97","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/97","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"python/TarSlip","severity":"warning","description":"Arbitrary File Write via Archive Extraction (Tar Slip)","name":"TarSlip","tags":["Security","TarSlip","python"],"full_description":"","help":"## Details\n\nZip Slip is a form of directory traversal that can be exploited by extracting files from an archive. The premise of the directory traversal vulnerability is that an attacker can gain access to parts of the file system outside of the target folder in which they should reside. The attacker can then overwrite executable files and either invoke them remotely or wait for the system or user to call them, thus achieving remote command execution on the victimâ€™s machine. The vulnerability can also cause damage by overwriting configuration files or other sensitive resources, and can be exploited on both client (user) machines and servers.\n\n## Example\n\nThe following is an example of a `zip` archive with one benign file and one malicious file. Extracting the malicious file will result in traversing out of the target folder, ending up in `/root/.ssh/` overwriting the `authorized_keys` file:\n\n```\n2018-04-15 22:04:29 .....           19           19  good.txt\n2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys\n```"},"tool":{"name":"SnykCode","guid":null,"version":"1.1302.0"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/snyk.yml:snyk-code","environment":"{}","category":"Snyk/Code","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Calling extractall to extract all files from a tar file without sanitization. This may result files outside destination directory to be overwritten, resulting in an arbitrary file write."},"location":{"path":"ui/pages/cookbook_analysis.py","start_line":308,"end_line":308,"start_column":9,"end_column":27},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/97/instances","dismissal_approved_by":null,"assignees":[]},{"number":90,"created_at":"2026-01-17T03:32:34Z","updated_at":"2026-01-17T13:06:58Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/90","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/90","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_analyse_cookbook_for_awx' is not used.\nImport of '_analyse_cookbooks_directory' is not used.\nImport of '_detect_deployment_patterns_in_recipe' is not used.\nImport of '_extract_cookbook_attributes' is not used.\nImport of '_extract_cookbook_dependencies' is not used.\nImport of '_format_chef_resources_analysis' is not used.\nImport of '_format_cookbook_analysis' is not used.\nImport of '_format_deployment_patterns' is not used.\nImport of '_generate_deployment_migration_recommendations' is not used.\nImport of '_generate_survey_fields_from_attributes' is not used.\nImport of '_parse_chef_runlist' is not used.\nImport of '_recommend_ansible_strategies' is not used.\nImport of 'convert_chef_deployment_to_ansible_strategy' is not used.\nImport of 'generate_awx_inventory_source_from_chef' is not used.\nImport of 'generate_awx_job_template_from_cookbook' is not used.\nImport of 'generate_awx_project_from_cookbooks' is not used.\nImport of 'generate_awx_workflow_from_chef_runlist' is not used.\nImport of 'generate_blue_green_deployment_playbook' is not used.\nImport of 'generate_canary_deployment_strategy' is not used."},"location":{"path":"souschef/server.py","start_line":141,"end_line":162,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/90/instances","dismissal_approved_by":null,"assignees":[]},{"number":89,"created_at":"2026-01-17T03:32:34Z","updated_at":"2026-01-17T13:06:58Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/89","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/89","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/ui/pages/cookbook_analysis.py","start_line":559,"end_line":559,"start_column":30,"end_column":38},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/89/instances","dismissal_approved_by":null,"assignees":[]},{"number":88,"created_at":"2026-01-17T03:32:34Z","updated_at":"2026-01-17T13:06:58Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/88","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/88","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/ui/pages/cookbook_analysis.py","start_line":559,"end_line":559,"start_column":8,"end_column":16},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/88/instances","dismissal_approved_by":null,"assignees":[]},{"number":86,"created_at":"2026-01-15T05:19:01Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/86","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/86","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/ui/pages/cookbook_analysis.py","start_line":580,"end_line":580,"start_column":25,"end_column":34},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/86/instances","dismissal_approved_by":null,"assignees":[]},{"number":85,"created_at":"2026-01-15T05:19:01Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/85","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/85","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/ui/pages/cookbook_analysis.py","start_line":578,"end_line":578,"start_column":26,"end_column":46},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/85/instances","dismissal_approved_by":null,"assignees":[]},{"number":84,"created_at":"2026-01-15T05:19:01Z","updated_at":"2026-01-17T13:06:58Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/84","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/84","state":"fixed","fixed_at":"2026-01-17T13:06:58Z","dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"fixed","commit_sha":"7007c7d89d8f215add5a78c44c7ef6dddf09d521","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/ui/pages/cookbook_analysis.py","start_line":54,"end_line":54,"start_column":30,"end_column":38},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/84/instances","dismissal_approved_by":null,"assignees":[]},{"number":83,"created_at":"2026-01-15T05:19:01Z","updated_at":"2026-01-17T13:06:58Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/83","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/83","state":"fixed","fixed_at":"2026-01-17T13:06:58Z","dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"fixed","commit_sha":"7007c7d89d8f215add5a78c44c7ef6dddf09d521","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/ui/pages/cookbook_analysis.py","start_line":54,"end_line":54,"start_column":8,"end_column":16},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/83/instances","dismissal_approved_by":null,"assignees":[]},{"number":81,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/81","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/81","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/core/path_utils.py","start_line":53,"end_line":53,"start_column":14,"end_column":40},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/81/instances","dismissal_approved_by":null,"assignees":[]},{"number":80,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/80","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/80","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/core/path_utils.py","start_line":33,"end_line":33,"start_column":16,"end_column":30},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/80/instances","dismissal_approved_by":null,"assignees":[]},{"number":78,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/78","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/78","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":1053,"end_line":1053,"start_column":14,"end_column":23},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/78/instances","dismissal_approved_by":null,"assignees":[]},{"number":77,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/77","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/77","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":1052,"end_line":1052,"start_column":8,"end_column":17},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/77/instances","dismissal_approved_by":null,"assignees":[]},{"number":76,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/76","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/76","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":1042,"end_line":1042,"start_column":14,"end_column":27},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/76/instances","dismissal_approved_by":null,"assignees":[]},{"number":75,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/75","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/75","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":1041,"end_line":1041,"start_column":8,"end_column":21},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/75/instances","dismissal_approved_by":null,"assignees":[]},{"number":74,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/74","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/74","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":667,"end_line":667,"start_column":28,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/74/instances","dismissal_approved_by":null,"assignees":[]},{"number":73,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/73","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/73","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":666,"end_line":666,"start_column":8,"end_column":19},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/73/instances","dismissal_approved_by":null,"assignees":[]},{"number":72,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/72","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/72","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":647,"end_line":647,"start_column":18,"end_column":52},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/72/instances","dismissal_approved_by":null,"assignees":[]},{"number":71,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/71","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/71","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":648,"end_line":648,"start_column":12,"end_column":46},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/71/instances","dismissal_approved_by":null,"assignees":[]},{"number":70,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/70","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/70","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":641,"end_line":641,"start_column":18,"end_column":56},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/70/instances","dismissal_approved_by":null,"assignees":[]},{"number":69,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/69","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/69","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":642,"end_line":642,"start_column":12,"end_column":50},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/69/instances","dismissal_approved_by":null,"assignees":[]},{"number":68,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/68","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/68","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":638,"end_line":638,"start_column":29,"end_column":40},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/68/instances","dismissal_approved_by":null,"assignees":[]},{"number":67,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/67","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/67","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":638,"end_line":638,"start_column":59,"end_column":70},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/67/instances","dismissal_approved_by":null,"assignees":[]},{"number":66,"created_at":"2026-01-15T05:05:28Z","updated_at":"2026-01-15T05:27:31Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/66","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/66","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/path-injection","severity":"error","description":"Uncontrolled data used in path expression","name":"py/path-injection","tags":["correctness","external/cwe/cwe-022","external/cwe/cwe-023","external/cwe/cwe-036","external/cwe/cwe-073","external/cwe/cwe-099","security"],"full_description":"Accessing paths influenced by users can allow an attacker to access unexpected resources.","help":"# Uncontrolled data used in path expression\nAccessing files using paths constructed from user-controlled data can allow an attacker to access unexpected resources. This can result in sensitive information being revealed or deleted, or an attacker being able to influence behavior by modifying unexpected files.\n\n\n## Recommendation\nValidate user input before using it to construct a file path, either using an off-the-shelf library function like `werkzeug.utils.secure_filename`, or by performing custom validation.\n\nIdeally, follow these rules:\n\n* Do not allow more than a single \".\" character.\n* Do not allow directory separators such as \"/\" or \"\\\\\" (depending on the file system).\n* Do not rely on simply replacing problematic sequences such as \"../\". For example, after applying this filter to \".../...//\", the resulting string would still be \"../\".\n* Use an allowlist of known good patterns.\n\n## Example\nIn the first example, a file name is read from an HTTP request and then used to access a file. However, a malicious user could enter a file name that is an absolute path, such as `\"/etc/passwd\"`.\n\nIn the second example, it appears that the user is restricted to opening a file within the `\"user\"` home directory. However, a malicious user could enter a file name containing special characters. For example, the string `\"../../../etc/passwd\"` will result in the code reading the file located at `\"/server/static/images/../../../etc/passwd\"`, which is the system's password file. This file would then be sent back to the user, giving them access to all the system's passwords. Note that a user could also use an absolute path here, since the result of `os.path.join(\"/server/static/images/\", \"/etc/passwd\")` is `\"/etc/passwd\"`.\n\nIn the third example, the path used to access the file system is normalized *before* being checked against a known prefix. This ensures that regardless of the user input, the resulting path is safe.\n\n\n```python\nimport os.path\nfrom flask import Flask, request, abort\n\napp = Flask(__name__)\n\n@app.route(\"/user_picture1\")\ndef user_picture1():\n    filename = request.args.get('p')\n    # BAD: This could read any file on the file system\n    data = open(filename, 'rb').read()\n    return data\n\n@app.route(\"/user_picture2\")\ndef user_picture2():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    # BAD: This could still read any file on the file system\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return data\n\n@app.route(\"/user_picture3\")\ndef user_picture3():\n    base_path = '/server/static/images'\n    filename = request.args.get('p')\n    #GOOD -- Verify with normalised version of path\n    fullpath = os.path.normpath(os.path.join(base_path, filename))\n    if not fullpath.startswith(base_path):\n        raise Exception(\"not allowed\")\n    data = open(fullpath, 'rb').read()\n    return data\n\n```\n\n## References\n* OWASP: [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal).\n* npm: [werkzeug.utils.secure_filename](http://werkzeug.pocoo.org/docs/utils/#werkzeug.utils.secure_filename).\n* Common Weakness Enumeration: [CWE-22](https://cwe.mitre.org/data/definitions/22.html).\n* Common Weakness Enumeration: [CWE-23](https://cwe.mitre.org/data/definitions/23.html).\n* Common Weakness Enumeration: [CWE-36](https://cwe.mitre.org/data/definitions/36.html).\n* Common Weakness Enumeration: [CWE-73](https://cwe.mitre.org/data/definitions/73.html).\n* Common Weakness Enumeration: [CWE-99](https://cwe.mitre.org/data/definitions/99.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"open","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This path depends on a user-provided value.\nThis path depends on a user-provided value."},"location":{"path":"souschef/assessment.py","start_line":321,"end_line":321,"start_column":16,"end_column":33},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/66/instances","dismissal_approved_by":null,"assignees":[]},{"number":47,"created_at":"2026-01-12T07:27:24Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/47","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/47","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_convert_inspec_to_ansible_assert' is not used.\nImport of '_convert_inspec_to_goss' is not used.\nImport of '_convert_inspec_to_serverspec' is not used.\nImport of '_convert_inspec_to_testinfra' is not used.\nImport of '_extract_inspec_describe_blocks' is not used."},"location":{"path":"souschef/server.py","start_line":218,"end_line":226,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/47/instances","dismissal_approved_by":null,"assignees":[]},{"number":43,"created_at":"2026-01-08T03:13:07Z","updated_at":"2026-01-09T05:11:23Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/43","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/43","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-09T05:11:23Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_normalize_ruby_value' is not used."},"location":{"path":"souschef/server.py","start_line":122,"end_line":124,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/43/instances","dismissal_approved_by":null,"assignees":[]},{"number":41,"created_at":"2026-01-07T20:52:37Z","updated_at":"2026-01-08T03:43:16Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/41","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/41","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-08T03:43:16Z","dismissed_reason":"false positive","dismissed_comment":"Required for tests","rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of 'ValidationCategory' is not used.\nImport of 'ValidationEngine' is not used.\nImport of 'ValidationLevel' is not used.\nImport of 'ValidationResult' is not used."},"location":{"path":"souschef/server.py","start_line":129,"end_line":134,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/41/instances","dismissal_approved_by":null,"assignees":[]},{"number":39,"created_at":"2026-01-07T20:52:37Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/39","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/39","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of 'ACTION_TO_STATE' is not used.\nImport of 'ANSIBLE_SERVICE_MODULE' is not used.\nImport of 'RESOURCE_MAPPINGS' is not used."},"location":{"path":"souschef/server.py","start_line":105,"end_line":111,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/39/instances","dismissal_approved_by":null,"assignees":[]},{"number":38,"created_at":"2026-01-07T20:03:07Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/38","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/38","state":"dismissed","fixed_at":"2026-01-17T13:06:58Z","dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"7007c7d89d8f215add5a78c44c7ef6dddf09d521","message":{"text":"Import of '_analyze_cookbook_for_awx' is not used.\nImport of '_analyze_cookbooks_directory' is not used.\nImport of '_detect_deployment_patterns_in_recipe' is not used.\nImport of '_extract_cookbook_attributes' is not used.\nImport of '_extract_cookbook_dependencies' is not used.\nImport of '_format_chef_resources_analysis' is not used.\nImport of '_format_cookbook_analysis' is not used.\nImport of '_format_deployment_patterns' is not used.\nImport of '_generate_deployment_migration_recommendations' is not used.\nImport of '_generate_survey_fields_from_attributes' is not used.\nImport of '_parse_chef_runlist' is not used.\nImport of '_recommend_ansible_strategies' is not used.\nImport of 'analyze_chef_application_patterns' is not used.\nImport of 'convert_chef_deployment_to_ansible_strategy' is not used.\nImport of 'generate_awx_inventory_source_from_chef' is not used.\nImport of 'generate_awx_job_template_from_cookbook' is not used.\nImport of 'generate_awx_project_from_cookbooks' is not used.\nImport of 'generate_awx_workflow_from_chef_runlist' is not used.\nImport of 'generate_blue_green_deployment_playbook' is not used.\nImport of 'generate_canary_deployment_strategy' is not used."},"location":{"path":"souschef/server.py","start_line":141,"end_line":162,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/38/instances","dismissal_approved_by":null,"assignees":[]},{"number":36,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/36","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/36","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_convert_erb_to_jinja2' is not used.\nImport of '_extract_code_block_variables' is not used.\nImport of '_extract_heredoc_strings' is not used.\nImport of '_extract_node_attribute_path' is not used.\nImport of '_extract_output_variables' is not used.\nImport of '_extract_template_variables' is not used.\nImport of '_strip_ruby_comments' is not used."},"location":{"path":"souschef/server.py","start_line":264,"end_line":272,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/36/instances","dismissal_approved_by":null,"assignees":[]},{"number":35,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/35","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/35","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_extract_resource_actions' is not used.\nImport of '_extract_resource_properties' is not used."},"location":{"path":"souschef/server.py","start_line":257,"end_line":260,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/35/instances","dismissal_approved_by":null,"assignees":[]},{"number":34,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/34","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/34","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_extract_conditionals' is not used.\nImport of '_extract_resources' is not used.\nImport of '_format_resources' is not used."},"location":{"path":"souschef/server.py","start_line":249,"end_line":253,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/34/instances","dismissal_approved_by":null,"assignees":[]},{"number":33,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/33","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/33","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_extract_metadata' is not used.\nImport of '_format_cookbook_structure' is not used.\nImport of '_format_metadata' is not used."},"location":{"path":"souschef/server.py","start_line":235,"end_line":239,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/33/instances","dismissal_approved_by":null,"assignees":[]},{"number":32,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T07:31:46Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/32","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/32","state":"fixed","fixed_at":"2026-01-12T07:31:46Z","dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"fixed","commit_sha":"1885a222ae08a7375c9dc3ef23ae273db6a85b40","message":{"text":"Import of '_convert_inspec_to_ansible_assert' is not used.\nImport of '_convert_inspec_to_testinfra' is not used.\nImport of '_extract_inspec_describe_blocks' is not used."},"location":{"path":"souschef/server.py","start_line":221,"end_line":227,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/32/instances","dismissal_approved_by":null,"assignees":[]},{"number":31,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/31","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/31","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_extract_plan_array' is not used.\nImport of '_extract_plan_exports' is not used.\nImport of '_extract_plan_function' is not used.\nImport of '_extract_plan_var' is not used.\nImport of '_update_quote_state' is not used."},"location":{"path":"souschef/server.py","start_line":205,"end_line":211,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/31/instances","dismissal_approved_by":null,"assignees":[]},{"number":30,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/30","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/30","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_extract_attributes' is not used.\nImport of '_format_attributes' is not used.\nImport of '_format_resolved_attributes' is not used.\nImport of '_get_precedence_level' is not used.\nImport of '_resolve_attribute_precedence' is not used."},"location":{"path":"souschef/server.py","start_line":193,"end_line":199,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/30/instances","dismissal_approved_by":null,"assignees":[]},{"number":28,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-08T04:18:15Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/28","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/28","state":"fixed","fixed_at":"2026-01-08T04:18:15Z","dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"fixed","commit_sha":"2a73940d084eb45d902938d080b3122100857ebf","message":{"text":"Import of '_normalize_ruby_value' is not used."},"location":{"path":"souschef/server.py","start_line":109,"end_line":111,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/28/instances","dismissal_approved_by":null,"assignees":[]},{"number":27,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/27","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/27","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_convert_chef_resource_to_ansible' is not used.\nImport of '_format_ansible_task' is not used.\nImport of '_get_file_params' is not used.\nImport of '_get_service_params' is not used."},"location":{"path":"souschef/server.py","start_line":92,"end_line":97,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/27/instances","dismissal_approved_by":null,"assignees":[]},{"number":26,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/26","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/26","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_add_general_recommendations' is not used.\nImport of '_convert_chef_block_to_ansible' is not used.\nImport of '_convert_chef_condition_to_ansible' is not used.\nImport of '_convert_guards_to_when_conditions' is not used.\nImport of '_create_handler' is not used.\nImport of '_create_handler_with_timing' is not used.\nImport of '_determine_query_complexity' is not used.\nImport of '_extract_chef_guards' is not used.\nImport of '_extract_enhanced_notifications' is not used.\nImport of '_extract_guard_patterns' is not used.\nImport of '_extract_search_patterns_from_cookbook' is not used.\nImport of '_extract_search_patterns_from_file' is not used.\nImport of '_find_search_patterns_in_content' is not used.\nImport of '_generate_ansible_inventory_from_search' is not used.\nImport of '_generate_group_name_from_condition' is not used.\nImport of '_generate_inventory_script_content' is not used.\nImport of '_get_current_timestamp' is not used.\nImport of '_parse_chef_search_query' is not used.\nImport of '_parse_guard_array' is not used.\nImport of '_parse_search_condition' is not used.\nImport of '_process_subscribes' is not used."},"location":{"path":"souschef/server.py","start_line":56,"end_line":78,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/26/instances","dismissal_approved_by":null,"assignees":[]},{"number":25,"created_at":"2026-01-07T11:17:11Z","updated_at":"2026-01-12T11:28:36Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/25","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/25","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-12T11:28:36Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/unused-import","severity":"note","description":"Unused import","name":"py/unused-import","tags":["maintainability","quality","useless-code"],"full_description":"Import is not required as it is not used","help":"# Unused import\nA module is imported (using the `import` statement) but that module is never used. This creates a dependency that does not need to exist and makes the code more difficult to read.\n\n\n## Recommendation\nDelete the import statement.\n\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"Import of '_add_service_build' is not used.\nImport of '_add_service_dependencies' is not used.\nImport of '_add_service_environment' is not used.\nImport of '_add_service_ports' is not used.\nImport of '_add_service_volumes' is not used.\nImport of '_build_compose_service' is not used.\nImport of '_extract_default_port' is not used.\nImport of '_map_habitat_deps_to_apt' is not used.\nImport of '_needs_data_volume' is not used.\nImport of '_validate_docker_image_name' is not used.\nImport of '_validate_docker_network_name' is not used."},"location":{"path":"souschef/server.py","start_line":34,"end_line":46,"start_column":1,"end_column":2},"classifications":[]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/25/instances","dismissal_approved_by":null,"assignees":[]},{"number":16,"created_at":"2026-01-06T08:19:31Z","updated_at":"2026-01-09T06:32:13Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/16","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/16","state":"fixed","fixed_at":"2026-01-09T06:32:13Z","dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"py/repeated-import","severity":"note","description":"Module is imported more than once","name":"py/repeated-import","tags":["maintainability","quality","useless-code"],"full_description":"Importing a module a second time has no effect and impairs readability","help":"# Module is imported more than once\nImporting the same module more than once has no effect as each module is only loaded once. It also confuses readers of the code.\n\n\n## Recommendation\nRemove the second import.\n\n\n## Example\n\n```python\nimport module1\nimport module2\nimport module1 # Duplicate import\n\n```\n\n## References\n* Python: [import statement](http://docs.python.org/reference/simple_stmts.html#import).\n"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"fixed","commit_sha":"8b4b49a003dff90353d98a57c21539682366e3bd","message":{"text":"This import of module json is redundant, as it was previously imported on line 5."},"location":{"path":"tests/test_server.py","start_line":13175,"end_line":13175,"start_column":9,"end_column":20},"classifications":["test"]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/16/instances","dismissal_approved_by":null,"assignees":[]},{"number":10,"created_at":"2026-01-05T03:07:38Z","updated_at":"2026-01-05T03:20:49Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/10","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/10","state":"dismissed","fixed_at":"2026-01-07T20:27:47Z","dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-05T03:20:49Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"python/NoHardcodedPasswords/test","severity":"note","description":"Use of Hardcoded Passwords","name":"NoHardcodedPasswords/test","tags":["InTest","NoHardcodedPasswords","Security","python"],"full_description":"","help":"\n## Details\n\nDevelopers may use hardcoded passwords during development to streamline setup or simplify authentication while testing. Although these passwords are intended to be removed before deployment, they are sometimes inadvertently left in the code. This introduces serious security risks, especially if the password grants elevated privileges or is reused across multiple systems.\n\nAn attacker who discovers a hardcoded password can potentially gain unauthorized access, escalate privileges, exfiltrate sensitive data, or disrupt service availability. If the password is reused across different environments or applications, the compromise can spread quickly and broadly.\n\n## Best practices for prevention\n* Plan software architecture such that keys and passwords are always stored outside the code, wherever possible.\n* Plan encryption into software architecture for all credential information and ensure proper handling of keys, credentials, and passwords.\n* Prompt for a secure password on first login rather than hard-code a default password.\n* If a hardcoded password or credential must be used, limit its use, for example, to system console users rather than via the network.\n* Use strong hashes for inbound password authentication, ideally with randomly assigned salts to increase the difficulty level in case of brute-force attack."},"tool":{"name":"SnykCode","guid":null,"version":"1.1302.0"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/snyk.yml:snyk-code","environment":"{}","category":"Snyk/Code","state":"dismissed","commit_sha":"bb1fcea0e1586feda509577a574dd034e735cac9","message":{"text":"Do not hardcode passwords in code. Found hardcoded password used in a dictionary key."},"location":{"path":"tests/test_server.py","start_line":1976,"end_line":1976,"start_column":9,"end_column":32},"classifications":["test"]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/10/instances","dismissal_approved_by":null,"assignees":[]},{"number":3,"created_at":"2026-01-04T11:52:44Z","updated_at":"2026-01-05T03:22:17Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/3","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/3","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-05T03:22:17Z","dismissed_reason":"used in tests","dismissed_comment":null,"rule":{"id":"py/clear-text-storage-sensitive-data","severity":"error","description":"Clear-text storage of sensitive information","name":"py/clear-text-storage-sensitive-data","tags":["external/cwe/cwe-312","external/cwe/cwe-315","external/cwe/cwe-359","security"],"full_description":"Sensitive information stored without encryption or hashing can expose it to an attacker.","help":"# Clear-text storage of sensitive information\nSensitive information that is stored unencrypted is accessible to an attacker who gains access to the storage. This is particularly important for cookies, which are stored on the machine of the end-user.\n\n\n## Recommendation\nEnsure that sensitive information is always encrypted before being stored. If possible, avoid placing sensitive information in cookies altogether. Instead, prefer storing, in the cookie, a key that can be used to look up the sensitive information.\n\nIn general, decrypt sensitive information only at the point where it is necessary for it to be used in cleartext.\n\nBe aware that external processes often store the `standard out` and `standard error` streams of the application, causing logged sensitive information to be stored as well.\n\n\n## Example\nThe following example code stores user credentials (in this case, their password) in a cookie in plain text:\n\n\n```python\nfrom flask import Flask, make_response, request\n\napp = Flask(\"Leak password\")\n\n@app.route('/')\ndef index():\n    password = request.args.get(\"password\")\n    resp = make_response(render_template(...))\n    resp.set_cookie(\"password\", password)\n    return resp\n\n```\nInstead, the credentials should be encrypted, for instance by using the `cryptography` module, or not stored at all.\n\n\n## References\n* M. Dowd, J. McDonald and J. Schuhm, *The Art of Software Security Assessment*, 1st Edition, Chapter 2 - 'Common Vulnerabilities of Encryption', p. 43. Addison Wesley, 2006.\n* M. Howard and D. LeBlanc, *Writing Secure Code*, 2nd Edition, Chapter 9 - 'Protecting Secret Data', p. 299. Microsoft, 2002.\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-315](https://cwe.mitre.org/data/definitions/315.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"This expression stores sensitive data (secret) as clear text."},"location":{"path":"tests/test_server.py","start_line":3109,"end_line":3109,"start_column":33,"end_column":57},"classifications":["test"]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/3/instances","dismissal_approved_by":null,"assignees":[]},{"number":2,"created_at":"2026-01-04T11:29:05Z","updated_at":"2026-01-04T11:44:17Z","url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/2","html_url":"https://github.com/kpeacocke/souschef/security/code-scanning/2","state":"dismissed","fixed_at":null,"dismissed_by":{"login":"kpeacocke","id":2867691,"node_id":"MDQ6VXNlcjI4Njc2OTE=","avatar_url":"https://avatars.githubusercontent.com/u/2867691?v=4","gravatar_id":"","url":"https://api.github.com/users/kpeacocke","html_url":"https://github.com/kpeacocke","followers_url":"https://api.github.com/users/kpeacocke/followers","following_url":"https://api.github.com/users/kpeacocke/following{/other_user}","gists_url":"https://api.github.com/users/kpeacocke/gists{/gist_id}","starred_url":"https://api.github.com/users/kpeacocke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kpeacocke/subscriptions","organizations_url":"https://api.github.com/users/kpeacocke/orgs","repos_url":"https://api.github.com/users/kpeacocke/repos","events_url":"https://api.github.com/users/kpeacocke/events{/privacy}","received_events_url":"https://api.github.com/users/kpeacocke/received_events","type":"User","user_view_type":"public","site_admin":false},"dismissed_at":"2026-01-04T11:44:17Z","dismissed_reason":"false positive","dismissed_comment":"see code comment","rule":{"id":"py/incomplete-url-substring-sanitization","severity":"warning","description":"Incomplete URL substring sanitization","name":"py/incomplete-url-substring-sanitization","tags":["correctness","external/cwe/cwe-020","security"],"full_description":"Security checks on the substrings of an unparsed URL are often vulnerable to bypassing.","help":"# Incomplete URL substring sanitization\nSanitizing untrusted URLs is a common technique for preventing attacks such as request forgeries and malicious redirections. Usually, this is done by checking that the host of a URL is in a set of allowed hosts.\n\nHowever, treating the URL as a string and checking if one of the allowed hosts is a substring of the URL is very prone to errors. Malicious URLs can bypass such security checks by embedding one of the allowed hosts in an unexpected location.\n\nEven if the substring check is not used in a security-critical context, the incomplete check may still cause undesirable behaviors when the check succeeds accidentally.\n\n\n## Recommendation\nParse a URL before performing a check on its host value, and ensure that the check handles arbitrary subdomain sequences correctly.\n\n\n## Example\nThe following example code checks that a URL redirection will reach the `example.com` domain.\n\n\n```python\nfrom flask import Flask, request, redirect\nfrom urllib.parse import urlparse\n\napp = Flask(__name__)\n\n# Not safe, as \"evil-example.net/example.com\" would be accepted\n\n@app.route('/some/path/bad1')\ndef unsafe1(request):\n    target = request.args.get('target', '')\n    if \"example.com\" in target:\n        return redirect(target)\n\n# Not safe, as \"benign-looking-prefix-example.com\" would be accepted\n\n@app.route('/some/path/bad2')\ndef unsafe2(request):\n    target = request.args.get('target', '')\n    if target.endswith(\"example.com\"):\n        return redirect(target)\n\n\n\n#Simplest and safest approach is to use an allowlist\n\n@app.route('/some/path/good1')\ndef safe1(request):\n    allowlist = [\n        \"example.com/home\",\n        \"example.com/login\",\n    ]\n    target = request.args.get('target', '')\n    if target in allowlist:\n        return redirect(target)\n\n#More complex example allowing sub-domains.\n\n@app.route('/some/path/good2')\ndef safe2(request):\n    target = request.args.get('target', '')\n    host = urlparse(target).hostname\n    #Note the '.' preceding example.com\n    if host and host.endswith(\".example.com\"):\n        return redirect(target)\n\n\n```\nThe first two examples show unsafe checks that are easily bypassed. In `unsafe1` the attacker can simply add `example.com` anywhere in the url. For example, `http://evil-example.net/example.com`.\n\nIn `unsafe2` the attacker must use a hostname ending in `example.com`, but that is easy to do. For example, `http://benign-looking-prefix-example.com`.\n\nThe second two examples show safe checks. In `safe1`, an allowlist is used. Although fairly inflexible, this is easy to get right and is most likely to be safe.\n\nIn `safe2`, `urlparse` is used to parse the URL, then the hostname is checked to make sure it ends with `.example.com`.\n\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* OWASP: [XSS Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n","security_severity_level":"high"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.9"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":".github/workflows/codeql.yml:analyze","environment":"{}","category":"/language:python","state":"dismissed","commit_sha":"e8b5b28ddc9ab5f8b8e79bf28ecacd5986127f1d","message":{"text":"The string db.example.com may be at an arbitrary position in the sanitized URL."},"location":{"path":"tests/test_integration_accuracy.py","start_line":379,"end_line":379,"start_column":52,"end_column":78},"classifications":["test"]},"instances_url":"https://api.github.com/repos/kpeacocke/souschef/code-scanning/alerts/2/instances","dismissal_approved_by":null,"assignees":[]}]